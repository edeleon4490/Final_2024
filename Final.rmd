---
title: "Covid19 Vaccine Study Final 2024"
author: "Ever De Leon"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of sub populations tracked. Consider population subgroups by gender (guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbiage when referencing p-values in conclusions.

$H_0$ The COVID vaccine has no difference in effectiveness on people in different subgroups.

$H_A$ The COVID vaccine does have a difference in effectiveness on people in different subgroups.
 
### Method

The statistical analysis we will be using is catergorical ~ categorical, because all variables (subgroups) we are analyzing are categorical.

## Males

```{r}
maleData = filter (FinalData,sex == "M")
```

### Descriptive Results

#### Graphical Descriptive 

```{r}
barchartGC(~infected+treatment,data=maleData)
barchartGC(~infected+treatment,data=maleData, type="percent")

```

Based on the graph, it is showing us showing the distribution of infected Males for each level of the treatment (covid19 or ok). It looks as if the Males who got the vaccine had a less percentage chance of contracting covid19.

#### Numerical Descriptive

```{r}
table1 <- xtabs(~infected + treatment, data=maleData)
rowPerc(table1)
colPerc(table1)
```

These tables are showing us the distributions in exact percentages that were illustrated in the barcharts. The tables also confirm that those that were vaccinated had a lesser chance fo contracting covid19.

#### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The p-value is 0.0000000000001098 for the Chi-squared test, that there is a significant association between infected and treatment within the Male subroup.

Based on the Fisher exact test, we got a p-value of 0.0000000000004631, which suggest the same as the Chi-squared test.


## Females

### Results

```{r}
femaleData = filter (FinalData,sex == "F")
```

### Descriptive Results

#### Graphical Descriptive 

```{r}
barchartGC(~infected+treatment,data=femaleData)
barchartGC(~infected+treatment,data=femaleData, type="percent")
```

Based on the graph, it is showing us showing the distribution of infected Females for each level of the treatment (covid19 or ok). It looks as if the females cibtracted void19 and who got the vaccine had a less percentage chance of contracting covid19 than those who got the placebo.

#### Numerical Descriptive

```{r}
table2 <- xtabs(~infected + treatment, data=femaleData)
rowPerc(table2)
colPerc(table2)
```
The data from this table shows that from the female group that were infected with COVID 19, The unvaccinated 60% experienced symptoms while only vaccinated 40% of the female group experienced symptoms. It is also showing that within the female placebo group, 2.04% were infected with COVID, while only 1.37% of the vaccinated group contracted COVID.

#### Inferential Results

```{r}
chisq.test(table2)
chisqtestGC(table2)
fisher.test(table2)
```

The p-value is 0.0002732 for the Chi-squared test, that there is a significant association between infected and treatment within the Female subroup.

Based on the Fisher exact test, we got a p-value of 0.0002162, which suggest the same as the Chi-squared test.


## LGBTQ

### Results
```{r}
LGBTQData = filter (FinalData,LGBTQ == "gay")
```

### Descriptive Results

#### Graphical Descriptive 

```{r}
barchartGC(~infected+treatment,data=LGBTQData)
barchartGC(~infected+treatment,data=LGBTQData, type="percent")
```

This graph is showing that within the LGBTQ subgroup, those who got COVID and got vaccinated experienced significantly more symptoms than compared to those that got COVID that were unvaccinated. Those who did not get COVID and were both vaccinated and unvaccinated did not show any significant difference.


#### Numerical Descriptive

```{r}
table3 <- xtabs(~infected + treatment, data=LGBTQData)
rowPerc(table3)
colPerc(table3)
```

The data from this table shows that from the LGBTQ group that were infected with COVID 19, The unvaccinated 15.38% experienced symptoms while a staggering vaccinated 84.62% of the female group experienced symptoms. It is also showing that within the LGBTQ placebo group, 0.66% were infected with COVID, while 3.54% of the vaccinated group contracted COVID.

#### Inferential Results

```{r}
chisq.test(table3)
chisqtestGC(table3)
fisher.test(table3)
```

The p-value is 0.0000006668 for the Chi-squared test, that there is a significant association between infected and treatment within the LGBTQ subroup.

Based on the Fisher exact test, we got a p-value of 0.00000001029, which suggest the same as the Chi-squared test.


## Druggies

### Results

```{r}
DruggiesData = filter(FinalData, DrugUser == "yes")
```

### Descriptive Results

#### Graphical Descriptive 

```{r}
barchartGC(~infected+treatment,data=DruggiesData)
barchartGC(~infected+treatment,data=DruggiesData, type="percent")

```

This graph us showing that from the drug user group who contracted COVID, the ones who received the vaccine had more symptoms than those with the placebo while drug user group that did not contract COVID showed no difference between those who were vaccinated and not vaccinated.

### Numerical Descriptive

```{r}
table4 <- xtabs(~infected + treatment, data=DruggiesData)
rowPerc(table4)
colPerc(table4)
```
This table is showing that within the placebo drug user group, they experience 11.67% of symptoms while the vaccinated group experienced 88.33% of symptoms. It is also showing that 0.4% of the placebo group contracted COVID, while 3.06% of the vaccinated drug user group contracted COVID. There is a significant difference and effect between the placebo and COVID vaccine.

### Inferential Results

```{r}
chisq.test(table4)
chisqtestGC(table4)
fisher.test(table4)
```


Based on this chisq test, the p-value is 0.00000002842 

The fisher exact test showed a p-value of 0.00000232, which is showing that there is a  odds ratio of about 0.12%, suggesting that the odds of this occuring are lower in one group compared to the other, the 95% confidence ineravl supports this 



# Overall Results and Conclusions